{% extends 'base.html' %}

{% block title %}Todo List{% endblock %}

{% block content %}
<style>
    .todo-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        background-color: #ffffff;
        transition: all 0.3s ease;
    }
    .todo-item:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        transform: translateY(-2px);
    }
    .todo-item:nth-child(even) {
        background-color: #f8f9fa;
    }
    .todo-item.status-pending {
        border-left: 4px solid #6c757d;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    }
    .todo-item.status-in_progress {
        border-left: 4px solid #ffc107;
        background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        box-shadow: 0 2px 8px rgba(255, 193, 7, 0.15);
    }
    .todo-item.status-completed {
        border-left: 4px solid #28a745;
        background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.15);
    }
    .todo-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
    }
    .todo-description {
        color: #555;
        margin-bottom: 10px;
        font-size: 1rem;
        line-height: 1.5;
        padding: 8px 12px;
        background-color: rgba(0,0,0,0.03);
        border-radius: 6px;
        border-left: 3px solid #007bff;
        position: relative;
    }
    .todo-description:before {
        content: "üìù";
        position: absolute;
        left: -25px;
        top: 8px;
        font-size: 1rem;
    }
    .todo-description:empty {
        display: none;
    }
    .todo-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    .status-badge {
        font-size: 0.875rem;
        padding: 4px 12px;
        border-radius: 20px;
    }
    .todo-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        position: relative;
    }
    .btn-custom {
        border-radius: 25px;
        font-weight: 600;
        padding: 8px 16px;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
    }
    .btn-custom:before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
    }
    .btn-custom:hover:before {
        left: 100%;
    }
    .btn-progress-custom {
        background: linear-gradient(45deg, #17a2b8, #20c997);
        border-color: #17a2b8;
        color: white;
        box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
    }
    .btn-progress-custom:hover {
        background: linear-gradient(45deg, #138496, #1aa085);
        box-shadow: 0 6px 20px rgba(23, 162, 184, 0.4);
    }
    .btn-edit-custom {
        background: linear-gradient(45deg, #ffc107, #fd7e14);
        border-color: #ffc107;
        color: #212529;
        box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
    }
    .btn-edit-custom:hover {
        background: linear-gradient(45deg, #e0a800, #e8680d);
        box-shadow: 0 6px 20px rgba(255, 193, 7, 0.4);
    }
    .btn-complete-custom {
        background: linear-gradient(45deg, #28a745, #20c997);
        border-color: #28a745;
        color: white;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }
    .btn-complete-custom:hover {
        background: linear-gradient(45deg, #218838, #1aa085);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }
    .btn-delete-custom {
        background: linear-gradient(45deg, #dc3545, #c82333);
        border-color: #dc3545;
        color: white;
        box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
    }
    .btn-delete-custom:hover {
        background: linear-gradient(45deg, #c82333, #a02622);
        box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
    }
    .btn-icon {
        margin-right: 6px;
    }
    .btn-add-custom {
        background: linear-gradient(135deg, #007bff 0%, #6610f2 50%, #6f42c1 100%);
        border: none;
        color: white;
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
        font-size: 1.1rem;
        padding: 14px 24px;
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .btn-add-custom:before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }
    .btn-add-custom:hover:before {
        left: 100%;
    }
    .btn-add-custom:hover {
        transform: translateY(-3px) scale(1.08);
        box-shadow: 0 12px 35px rgba(0, 123, 255, 0.6);
        background: linear-gradient(135deg, #0056b3 0%, #5a0fc8 50%, #5a0fc8 100%);
    }
    .btn-add-custom:active {
        transform: translateY(-1px) scale(1.05);
        box-shadow: 0 6px 20px rgba(0, 123, 255, 0.5);
    }
    .btn-skip-custom {
        background: linear-gradient(45deg, #6c757d, #495057);
        border-color: #6c757d;
        color: white;
        box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        transition: all 0.5s ease;
        position: relative;
    }
    .btn-skip-custom.position-1 {
        background: linear-gradient(45deg, #5a6268, #343a40);
        position: absolute;
        top: -50px;
        right: 0;
        box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    }
    .btn-skip-custom.position-2 {
        background: linear-gradient(45deg, #5a6268, #343a40);
        position: absolute;
        top: -50px;
        left: 0;
        box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    }
    .btn-skip-custom.position-3 {
        background: linear-gradient(45deg, #5a6268, #343a40);
        position: absolute;
        bottom: -50px;
        right: 0;
        box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    }
    .btn-skip-custom.position-4 {
        background: linear-gradient(45deg, #5a6268, #343a40);
        position: absolute;
        bottom: -50px;
        left: 0;
        box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    }
</style>
<div class="container">
    <h1 class="mb-4">Todo List</h1>
    <a href="{% url 'create_todo' %}" class="btn btn-custom btn-add-custom mb-4">‚ûï Add New Todo</a>

    <div class="todo-list">
        {% for todo in todos %}
        <div class="todo-item status-{{ todo.status }}">
            <div class="todo-title">{{ todo.title }}</div>
            {% if todo.description %}
            <div class="todo-description">{{ todo.description }}</div>
            {% endif %}
            <div class="todo-meta">
                <span class="badge status-badge {% if todo.status == 'pending' %}bg-secondary{% elif todo.status == 'in_progress' %}bg-warning text-dark{% elif todo.status == 'completed' %}bg-success{% endif %}">
                    {{ todo.get_status_display }}
                </span>
                <small class="text-muted">Created: {{ todo.created_at|date:"M d, Y H:i" }}</small>
            </div>
            <div class="todo-actions">
                <button class="btn btn-custom btn-skip-custom btn-sm" onclick="toggleSkipButton(this)">‚è≠Ô∏è Skip</button>
                <a href="{% url 'progress_todo' todo.id %}" class="btn btn-custom btn-progress-custom btn-sm">
                    {% if todo.status == 'pending' %}Start{% elif todo.status == 'in_progress' %}Complete{% elif todo.status == 'completed' %}Restart{% endif %}
                </a>
                <a href="{% url 'edit_todo' todo.id %}" class="btn btn-custom btn-edit-custom btn-sm">Edit</a>
                <a href="{% url 'complete_todo' todo.id %}" class="btn btn-custom btn-delete-custom btn-sm" onclick="return confirm('Are you sure you want to delete this todo?')">Delete</a>
            </div>
        </div>
        {% empty %}
        <div class="text-center py-5">
            <p class="text-muted mb-4">No todos yet.</p>
            <a href="{% url 'create_todo' %}" class="btn btn-custom btn-add-custom">‚ûï Create Your First Todo</a>
        </div>
        {% endfor %}
    </div>
</div>
<script>
function toggleSkipButton(button) {
    if (button) {
        // Clear any existing timeout for this button
        if (button.dataset.timeoutId) {
            clearTimeout(button.dataset.timeoutId);
        }
        // Remove all position classes
        button.classList.remove('position-1', 'position-2', 'position-3', 'position-4');
        // Add a random position class
        const positions = ['position-1', 'position-2', 'position-3', 'position-4'];
        const randomPosition = positions[Math.floor(Math.random() * positions.length)];
        button.classList.add(randomPosition);
        // Set timeout to return to original position after 5 seconds
        const timeoutId = setTimeout(() => {
            button.classList.remove('position-1', 'position-2', 'position-3', 'position-4');
            delete button.dataset.timeoutId;
        }, 5000);
        button.dataset.timeoutId = timeoutId;
    } else {
        const buttons = document.querySelectorAll('.btn-skip-custom');
        buttons.forEach(btn => {
            // Clear any existing timeout for this button
            if (btn.dataset.timeoutId) {
                clearTimeout(btn.dataset.timeoutId);
            }
            btn.classList.remove('position-1', 'position-2', 'position-3', 'position-4');
            const positions = ['position-1', 'position-2', 'position-3', 'position-4'];
            const randomPosition = positions[Math.floor(Math.random() * positions.length)];
            btn.classList.add(randomPosition);
            // Set timeout to return to original position after 5 seconds
            const timeoutId = setTimeout(() => {
                btn.classList.remove('position-1', 'position-2', 'position-3', 'position-4');
                delete btn.dataset.timeoutId;
            }, 5000);
            btn.dataset.timeoutId = timeoutId;
        });
    }
}
</script>
{% endblock %}
